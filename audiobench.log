2025-06-27 13:27:55,442 - __main__ - INFO - [main] Starting main function.
2025-06-27 13:27:55,443 - __main__ - INFO - [main] Loading config file: config.yaml
2025-06-27 13:27:55,445 - __main__ - INFO - [main] Config loaded: {'dataset_metric': ['(alpaca_audio_test, word_error_rate)'], 'judge_concurrency': 4, 'judge_model': 'gpt-4o-mini', 'num_samples': 5, 'models': [{'info': {'name': 'audio_transcriptions_openai_1', 'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'batch_size': 50, 'chunk_size': 30}}]}
2025-06-27 13:27:55,445 - __main__ - INFO - [main] Loading models...
2025-06-27 13:27:55,445 - __main__ - INFO - [_load_models] Instantiating models from config: [{'info': {'name': 'audio_transcriptions_openai_1', 'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'batch_size': 50, 'chunk_size': 30}}]
2025-06-27 13:27:55,445 - __main__ - INFO - [_load_models] Instantiating model for audio_transcriptions_openai_1
2025-06-27 13:27:55,506 - __main__ - INFO - Loaded audio_transcriptions_openai_1
2025-06-27 13:27:55,507 - __main__ - INFO - [_load_models] Successfully instantiated 1 model(s).
2025-06-27 13:27:55,511 - __main__ - INFO - [main] Loading dataset 'alpaca_audio_test' with metric 'word_error_rate' ...
2025-06-27 13:27:55,511 - __main__ - INFO - [_load_dataset] Loading HuggingFace dataset repo: AudioLLMs/alpaca_audio_test
2025-06-27 13:27:58,230 - __main__ - INFO - [_load_dataset] Truncating dataset to first 5 samples.
2025-06-27 13:27:59,383 - __main__ - INFO - [_load_dataset] Preprocessing dataset using AudiobenchPreprocessor...
2025-06-27 13:27:59,384 - preprocessors.AudiobenchPreprocessor - INFO - In [AudiobenchPreprocessor] Processing dataset...
2025-06-27 13:27:59,384 - preprocessors.AudiobenchPreprocessor - INFO - Dataset keys: ['context', 'instruction', 'speech_instruction', 'answer'], num_samples: 5
2025-06-27 13:27:59,387 - preprocessors.AudiobenchPreprocessor - INFO - Dataset is 0.01 hours long
2025-06-27 13:27:59,387 - __main__ - INFO - [_load_dataset] Dataset loaded and processed. Size: 5
2025-06-27 13:27:59,387 - __main__ - INFO - [_load_metric] Loading metric: word_error_rate (judge_concurrency=4, judge_model=gpt-4o-mini)
2025-06-27 13:27:59,551 - __main__ - INFO - [_load_metric] Metric loaded: WER
2025-06-27 13:27:59,552 - __main__ - INFO - [main] Initializing Engine and running evaluation...
2025-06-27 13:27:59,552 - __main__ - INFO - [Engine.__init__] Initializing Engine with 1 model(s), dataset size: 5, metric: WER
2025-06-27 13:27:59,552 - __main__ - INFO - [Engine.run] Starting evaluation run.
2025-06-27 13:27:59,552 - __main__ - INFO - [Engine._infer_all] Starting inference for all models: ['audio_transcriptions_openai_1']
2025-06-27 13:27:59,552 - __main__ - INFO - [Engine._infer_single_model] Running model: audio_transcriptions_openai_1 on dataset of size 5
2025-06-27 13:27:59,559 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-27 13:27:59,565 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-27 13:27:59,566 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-27 13:27:59,567 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-27 13:27:59,568 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-27 13:28:00,673 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-27 13:28:00,674 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-27 13:28:00,675 - models.request_resp_handler - INFO - Successful Response
2025-06-27 13:28:00,681 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Telling me about the movie Star Wars."}
2025-06-27 13:28:00,682 - models.request_resp_handler - INFO - Successful Response
2025-06-27 13:28:00,689 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Suggest ways to reduce daily water use by households."}
2025-06-27 13:28:00,690 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-27 13:28:00,690 - models.request_resp_handler - INFO - Successful Response
2025-06-27 13:28:00,698 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Change the subject of the following sentence. The cat meowed."}
2025-06-27 13:28:00,726 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-27 13:28:00,726 - models.request_resp_handler - INFO - Successful Response
2025-06-27 13:28:00,737 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Classify the following movie, genres, comedy, action, drama."}
2025-06-27 13:28:00,746 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-27 13:28:00,747 - models.request_resp_handler - INFO - Successful Response
2025-06-27 13:28:00,756 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Calculate the area of a triangle with length 15 and width 30."}
2025-06-27 13:28:00,756 - __main__ - INFO - [Engine._infer_single_model] Model audio_transcriptions_openai_1 finished inference.
2025-06-27 13:28:00,756 - __main__ - INFO - [Engine._infer_all] All models finished inference.
2025-06-27 13:28:00,756 - __main__ - INFO - [Engine.run] Predictions complete. Calculating scores...
2025-06-27 13:28:00,757 - __main__ - INFO - [Engine.run] Scoring model: audio_transcriptions_openai_1
2025-06-27 13:28:00,757 - metrics.word_error_rate_metrics - INFO - [WERMetrics.__call__] Calculating WER for 5 samples.
2025-06-27 13:28:00,758 - metrics.word_error_rate_metrics - INFO - For sample 0: reference=Star Wars is a science fiction franchise that follows the adventures of various characters "a long time ago in a galaxy far, far away." The original trilogy, created by George Lucas, focuses on the Rebel Alliance's struggle against the tyrannical Galactic Empire and the journey of Luke Skywalker to become a Jedi. The franchise has since expanded to include prequels, sequels, spin-offs, books, and TV series. candidate= Telling me about the movie Star Wars.
2025-06-27 13:28:00,758 - metrics.word_error_rate_metrics - INFO - For sample 1: reference=1. Fix leaks promptly.
2. Install low-flow fixtures.
3. Take shorter showers.
4. Turn off water when brushing teeth or shaving.
5. Run dishwashers and washing machines with full loads.
6. Use a broom instead of a hose to clean driveways and sidewalks.
7. Collect rainwater for gardening. candidate= Suggest ways to reduce daily water use by households.
2025-06-27 13:28:00,759 - metrics.word_error_rate_metrics - INFO - For sample 2: reference=Comedy: Humorous
Action: Exciting
Drama: Emotional candidate= Change the subject of the following sentence. The cat meowed.
2025-06-27 13:28:00,759 - metrics.word_error_rate_metrics - INFO - For sample 3: reference=The area of the triangle is 225 square units. candidate= Classify the following movie, genres, comedy, action, drama.
2025-06-27 13:28:00,759 - metrics.word_error_rate_metrics - INFO - For sample 4: reference=The meow came from the cat. candidate= Calculate the area of a triangle with length 15 and width 30.
2025-06-27 13:28:00,759 - __main__ - INFO - [Engine.run] Evaluation complete. Returning scoresz.
2025-06-27 13:28:00,759 - __main__ - INFO - [main] Evaluation scores:
2025-06-27 13:28:00,759 - __main__ - INFO - {
  "alpaca_audio_test": {
    "WER": {
      "audio_transcriptions_openai_1": {
        "wer": 1.0352112676056338,
        "average_wer_per_row": 1.274
      }
    }
  }
}

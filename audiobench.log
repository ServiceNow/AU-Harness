2025-06-26 10:35:40,596 - __main__ - INFO - [main] Starting main function.
2025-06-26 10:35:40,596 - __main__ - INFO - [main] Loading config file: test_config.yaml
2025-06-26 10:35:40,600 - __main__ - INFO - [main] Config loaded: {'dataset_metric': ['(audiobench_wavcaps_qa_test, word_error_rate)', '(audiobench_alpaca_audio_test, word_error_rate)'], 'batch_size': 4, 'num_samples': 2, 'models': [{'name': 'audio_transcriptions_openai_1', 'info': {'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'sync_client': False, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'target': 'audio_transcriptions_openai'}}, {'name': 'audio_transcriptions_openai_2', 'info': {'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'sync_client': False, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'target': 'audio_transcriptions_openai'}}]}
2025-06-26 10:35:40,600 - __main__ - INFO - [main] Loading models...
2025-06-26 10:35:40,600 - __main__ - INFO - [_load_models] Instantiating models from config: [{'name': 'audio_transcriptions_openai_1', 'info': {'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'sync_client': False, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'target': 'audio_transcriptions_openai'}}, {'name': 'audio_transcriptions_openai_2', 'info': {'inference_type': 'inference_server', 'url': 'https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions', 'delay': 100, 'retry_attempts': 8, 'timeout': 30, 'sync_client': False, 'postprocessor': [], 'model': 'whisper-3', 'auth_token': 'Bearer 8o30OElfDYV_D6YbbznT0A:GDC2BsXIfSdfjv9iWka3V4MkazpvHfe0cCwXohzbP0Q', 'target': 'audio_transcriptions_openai'}}]
2025-06-26 10:35:40,600 - __main__ - INFO - [_load_models] Instantiating model: audio_transcriptions_openai_1
2025-06-26 10:35:40,600 - __main__ - INFO - [_load_models] Importing module: models.audio_transcriptions_openai
2025-06-26 10:35:40,601 - __main__ - INFO - [_load_models] Instantiated model class: AudioTranscriptionsOpenAI
2025-06-26 10:35:40,665 - __main__ - INFO - [_load_models] Instantiating model: audio_transcriptions_openai_2
2025-06-26 10:35:40,665 - __main__ - INFO - [_load_models] Importing module: models.audio_transcriptions_openai
2025-06-26 10:35:40,665 - __main__ - INFO - [_load_models] Instantiated model class: AudioTranscriptionsOpenAI
2025-06-26 10:35:40,678 - __main__ - INFO - Loaded audio_transcriptions_openai_1
2025-06-26 10:35:40,678 - __main__ - INFO - Loaded audio_transcriptions_openai_2
2025-06-26 10:35:40,678 - __main__ - INFO - [_load_models] Successfully instantiated 2 model(s).
2025-06-26 10:35:40,678 - __main__ - INFO - [main] Loading dataset 'audiobench_wavcaps_qa_test' with metric 'word_error_rate' ...
2025-06-26 10:35:40,678 - __main__ - INFO - [_load_dataset] Loading dataset: audiobench_wavcaps_qa_test
2025-06-26 10:35:40,679 - __main__ - INFO - [_load_dataset] Loading HuggingFace dataset repo: AudioLLMs/wavcaps_qa_test
2025-06-26 10:35:45,213 - __main__ - INFO - [_load_dataset] Truncating dataset to first 2 samples.
2025-06-26 10:35:46,804 - __main__ - INFO - [_load_dataset] Preprocessing dataset...
2025-06-26 10:35:46,804 - preprocessors.audio_preprocessor - INFO - In [AudioBenchPreprocessor] Processing dataset...
2025-06-26 10:35:46,804 - preprocessors.audio_preprocessor - INFO - Dataset keys: ['context', 'instruction', 'answer'], num_samples: 2
2025-06-26 10:35:46,808 - preprocessors.audio_preprocessor - INFO - Dataset is 0.01 hours long
2025-06-26 10:35:46,808 - __main__ - INFO - [_load_dataset] Dataset loaded and processed. Size: 2
2025-06-26 10:35:46,808 - __main__ - INFO - [_load_metric] Loading metric: word_error_rate
2025-06-26 10:35:47,017 - __main__ - INFO - [_load_metric] Metric loaded: WER
2025-06-26 10:35:47,017 - __main__ - INFO - [main] Initializing Engine and running evaluation...
2025-06-26 10:35:47,017 - __main__ - INFO - [Engine.__init__] Initializing Engine with 2 model(s), dataset size: 2, metric: WER, batch_size: 4
2025-06-26 10:35:47,017 - __main__ - INFO - [Engine.run] Starting evaluation run.
2025-06-26 10:35:47,017 - __main__ - INFO - Running on batch size 4
2025-06-26 10:35:47,018 - __main__ - INFO - [Engine._infer_all] Starting inference for all models: ['audio_transcriptions_openai_1', 'audio_transcriptions_openai_2']
2025-06-26 10:35:47,018 - __main__ - INFO - [Engine._infer_single_model] Running model: audio_transcriptions_openai_1 on dataset of size 2
2025-06-26 10:35:47,018 - __main__ - INFO - [Engine._infer_single_model] Running model: audio_transcriptions_openai_2 on dataset of size 2
2025-06-26 10:35:47,022 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:35:47,026 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:35:47,030 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:35:47,031 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:35:47,987 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:35:47,988 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:35:47,989 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:35:48,001 - models.model - INFO - audio_transcriptions_openai_2 model response: {"text":" Bye."}
2025-06-26 10:35:48,001 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:35:48,011 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Bye."}
2025-06-26 10:36:00,784 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:00,785 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:00,853 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*"}
2025-06-26 10:36:00,854 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:00,854 - __main__ - INFO - [Engine._infer_single_model] Model audio_transcriptions_openai_1 finished inference.
2025-06-26 10:36:00,854 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:00,908 - models.model - INFO - audio_transcriptions_openai_2 model response: {"text":" *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*"}
2025-06-26 10:36:00,908 - __main__ - INFO - [Engine._infer_single_model] Model audio_transcriptions_openai_2 finished inference.
2025-06-26 10:36:00,908 - __main__ - INFO - [Engine._infer_all] All models finished inference.
2025-06-26 10:36:00,908 - __main__ - INFO - [Engine._infer_all] Results: {'audio_transcriptions_openai_1': [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.'], 'audio_transcriptions_openai_2': [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.']}
2025-06-26 10:36:00,909 - __main__ - INFO - prediction type: <class 'dict'>
2025-06-26 10:36:00,909 - __main__ - INFO - predictions: {'audio_transcriptions_openai_1': [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.'], 'audio_transcriptions_openai_2': [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.']}
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] prediction length: 2
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] Predictions complete. Calculating scores...
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] Model targets: ['Yes, it might be doing certain cleaning job.', 'Sound of a machine gun firing can be heard in the audio.']
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] Scoring model: audio_transcriptions_openai_1
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] Outs type: <class 'list'>
2025-06-26 10:36:00,909 - __main__ - INFO - [Engine.run] Outs: [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.']
2025-06-26 10:36:00,909 - metrics.word_error_rate_metrics - INFO - [WERMetrics.__call__] Calculating WER for 2 samples.
2025-06-26 10:36:00,909 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text: Yes, it might be doing certain cleaning job.
2025-06-26 10:36:00,911 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text:  *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*
2025-06-26 10:36:00,912 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text: Sound of a machine gun firing can be heard in the audio.
2025-06-26 10:36:00,913 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text:  Bye.
2025-06-26 10:36:00,913 - __main__ - INFO - [Engine.run] Scoring model: audio_transcriptions_openai_2
2025-06-26 10:36:00,913 - __main__ - INFO - [Engine.run] Outs type: <class 'list'>
2025-06-26 10:36:00,913 - __main__ - INFO - [Engine.run] Outs: [' *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* *doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell* * Doorbell*', ' Bye.']
2025-06-26 10:36:00,913 - metrics.word_error_rate_metrics - INFO - [WERMetrics.__call__] Calculating WER for 2 samples.
2025-06-26 10:36:00,913 - __main__ - INFO - [Engine.run] Evaluation complete. Returning scoresz.
2025-06-26 10:36:00,913 - __main__ - INFO - [main] Loading dataset 'audiobench_alpaca_audio_test' with metric 'word_error_rate' ...
2025-06-26 10:36:00,913 - __main__ - INFO - [_load_dataset] Loading dataset: audiobench_alpaca_audio_test
2025-06-26 10:36:00,913 - __main__ - INFO - [_load_dataset] Loading HuggingFace dataset repo: AudioLLMs/alpaca_audio_test
2025-06-26 10:36:06,065 - __main__ - INFO - [_load_dataset] Truncating dataset to first 2 samples.
2025-06-26 10:36:06,065 - __main__ - INFO - [_load_dataset] Preprocessing dataset...
2025-06-26 10:36:06,066 - preprocessors.audio_preprocessor - INFO - In [AudioBenchPreprocessor] Processing dataset...
2025-06-26 10:36:06,066 - preprocessors.audio_preprocessor - INFO - Dataset keys: ['context', 'instruction', 'speech_instruction', 'answer'], num_samples: 2
2025-06-26 10:36:06,067 - preprocessors.audio_preprocessor - INFO - Dataset is 0.00 hours long
2025-06-26 10:36:06,067 - __main__ - INFO - [_load_dataset] Dataset loaded and processed. Size: 2
2025-06-26 10:36:06,067 - __main__ - INFO - [_load_metric] Loading metric: word_error_rate
2025-06-26 10:36:06,067 - __main__ - INFO - [_load_metric] Metric loaded: WER
2025-06-26 10:36:06,067 - __main__ - INFO - [main] Initializing Engine and running evaluation...
2025-06-26 10:36:06,067 - __main__ - INFO - [Engine.__init__] Initializing Engine with 2 model(s), dataset size: 2, metric: WER, batch_size: 4
2025-06-26 10:36:06,067 - __main__ - INFO - [Engine.run] Starting evaluation run.
2025-06-26 10:36:06,067 - __main__ - INFO - Running on batch size 4
2025-06-26 10:36:06,067 - __main__ - INFO - [Engine._infer_all] Starting inference for all models: ['audio_transcriptions_openai_1', 'audio_transcriptions_openai_2']
2025-06-26 10:36:06,067 - __main__ - INFO - [Engine._infer_single_model] Running model: audio_transcriptions_openai_1 on dataset of size 2
2025-06-26 10:36:06,067 - __main__ - INFO - [Engine._infer_single_model] Running model: audio_transcriptions_openai_2 on dataset of size 2
2025-06-26 10:36:06,068 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:06,069 - models.request_resp_handler - ERROR - audio_raw_response=Event loop is closed
2025-06-26 10:36:06,074 - models.model - INFO - audio_transcriptions_openai_1 model response: Event loop is closed
2025-06-26 10:36:06,075 - models.model - WARNING - [audio_transcriptions_openai_1] Retrying the request in 0.5422716595496851 seconds as it returned 500 code in attempt 1
2025-06-26 10:36:06,075 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:06,077 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:06,077 - models.request_resp_handler - ERROR - audio_raw_response=Event loop is closed
2025-06-26 10:36:06,083 - models.model - INFO - audio_transcriptions_openai_2 model response: Event loop is closed
2025-06-26 10:36:06,083 - models.model - WARNING - [audio_transcriptions_openai_2] Retrying the request in 0.7069392834799 seconds as it returned 500 code in attempt 1
2025-06-26 10:36:06,084 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:06,625 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:06,792 - models.request_resp_handler - INFO - URL: https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions
2025-06-26 10:36:07,057 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:07,059 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:07,068 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Suggest ways to reduce daily water use by households."}
2025-06-26 10:36:07,068 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:07,069 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:07,076 - models.model - INFO - audio_transcriptions_openai_2 model response: {"text":" Suggest ways to reduce daily water use by households."}
2025-06-26 10:36:07,628 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:07,631 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:07,638 - models.model - INFO - audio_transcriptions_openai_1 model response: {"text":" Telling me about the movie Star Wars."}
2025-06-26 10:36:07,638 - __main__ - INFO - [Engine._infer_single_model] Model audio_transcriptions_openai_1 finished inference.
2025-06-26 10:36:07,710 - httpx - INFO - HTTP Request: POST https://844b3c14-08c9-4de3-8c0b-79c84ef528ca-8000.job.console.elementai.com/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-06-26 10:36:07,712 - models.request_resp_handler - INFO - Successful Response
2025-06-26 10:36:07,718 - models.model - INFO - audio_transcriptions_openai_2 model response: {"text":" Telling me about the movie Star Wars."}
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine._infer_single_model] Model audio_transcriptions_openai_2 finished inference.
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine._infer_all] All models finished inference.
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine._infer_all] Results: {'audio_transcriptions_openai_1': [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.'], 'audio_transcriptions_openai_2': [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.']}
2025-06-26 10:36:07,719 - __main__ - INFO - prediction type: <class 'dict'>
2025-06-26 10:36:07,719 - __main__ - INFO - predictions: {'audio_transcriptions_openai_1': [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.'], 'audio_transcriptions_openai_2': [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.']}
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] prediction length: 2
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] Predictions complete. Calculating scores...
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] Model targets: ['Star Wars is a science fiction franchise that follows the adventures of various characters "a long time ago in a galaxy far, far away." The original trilogy, created by George Lucas, focuses on the Rebel Alliance\'s struggle against the tyrannical Galactic Empire and the journey of Luke Skywalker to become a Jedi. The franchise has since expanded to include prequels, sequels, spin-offs, books, and TV series.', '1. Fix leaks promptly.\n2. Install low-flow fixtures.\n3. Take shorter showers.\n4. Turn off water when brushing teeth or shaving.\n5. Run dishwashers and washing machines with full loads.\n6. Use a broom instead of a hose to clean driveways and sidewalks.\n7. Collect rainwater for gardening.']
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] Scoring model: audio_transcriptions_openai_1
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] Outs type: <class 'list'>
2025-06-26 10:36:07,719 - __main__ - INFO - [Engine.run] Outs: [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.']
2025-06-26 10:36:07,719 - metrics.word_error_rate_metrics - INFO - [WERMetrics.__call__] Calculating WER for 2 samples.
2025-06-26 10:36:07,720 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text: Star Wars is a science fiction franchise that follows the adventures of various characters "a long time ago in a galaxy far, far away." The original trilogy, created by George Lucas, focuses on the Rebel Alliance's struggle against the tyrannical Galactic Empire and the journey of Luke Skywalker to become a Jedi. The franchise has since expanded to include prequels, sequels, spin-offs, books, and TV series.
2025-06-26 10:36:07,720 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text:  Telling me about the movie Star Wars.
2025-06-26 10:36:07,720 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text: 1. Fix leaks promptly.
2. Install low-flow fixtures.
3. Take shorter showers.
4. Turn off water when brushing teeth or shaving.
5. Run dishwashers and washing machines with full loads.
6. Use a broom instead of a hose to clean driveways and sidewalks.
7. Collect rainwater for gardening.
2025-06-26 10:36:07,720 - metrics.word_error_rate_metrics - INFO - [normalize_text] Normalizing text:  Suggest ways to reduce daily water use by households.
2025-06-26 10:36:07,720 - __main__ - INFO - [Engine.run] Scoring model: audio_transcriptions_openai_2
2025-06-26 10:36:07,720 - __main__ - INFO - [Engine.run] Outs type: <class 'list'>
2025-06-26 10:36:07,720 - __main__ - INFO - [Engine.run] Outs: [' Telling me about the movie Star Wars.', ' Suggest ways to reduce daily water use by households.']
2025-06-26 10:36:07,720 - metrics.word_error_rate_metrics - INFO - [WERMetrics.__call__] Calculating WER for 2 samples.
2025-06-26 10:36:07,720 - __main__ - INFO - [Engine.run] Evaluation complete. Returning scoresz.
2025-06-26 10:36:07,720 - __main__ - INFO - [main] Evaluation scores:
2025-06-26 10:36:07,720 - __main__ - INFO - {
  "audiobench_wavcaps_qa_test": {
    "WER": {
      "audio_transcriptions_openai_1": {
        "wer": 6.15,
        "average_wer_per_row": 7.438
      },
      "audio_transcriptions_openai_2": {
        "wer": 6.15,
        "average_wer_per_row": 7.438
      }
    }
  },
  "audiobench_alpaca_audio_test": {
    "WER": {
      "audio_transcriptions_openai_1": {
        "wer": 0.9743589743589743,
        "average_wer_per_row": 0.972
      },
      "audio_transcriptions_openai_2": {
        "wer": 0.9743589743589743,
        "average_wer_per_row": 0.972
      }
    }
  }
}
